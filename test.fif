#!/usr/bin/fift -s
"TonUtil.fif" include
"Asm.fif" include


-1 constant recv_external

"casino.fif" include <s constant code

"new-contract" =: file-base
0 =: subwallet-id

file-base +".addr" load-address 2constant wallet_addr

<b 0 32 u, subwallet-id 32 u, 
	file-base +".pk" load-generate-keypair
	constant wallet_pk B, 1 4 u,
	
	now 120 - 32 u, 500000000 64 u, 0 64 u,
	
	<b 195 64 u, wallet_addr addr, 
	 	<b 17408 64 u, wallet_addr addr,
			<b 17408 64 u, wallet_addr addr,
				<b 17408 64 u, wallet_addr addr,
					<b 17408 64 u, wallet_addr addr,
						<b 17408 64 u, wallet_addr addr,
							<b 17408 64 u, wallet_addr addr,
								<b 17408 64 u, wallet_addr addr,
									<b 
									b> ref,
								b> ref,
							b> ref,
						b> ref,
					b> ref,
				b> ref,
			b> ref,
		b> ref, 
	b> ref, 
	
b> constant storage

<b 0 32 u, 0 32 u, 255 8 u, <b b> ref, b>
dup hashu wallet_pk ed25519_sign_uint
<b swap B, swap <s s, b>

<s constant message


0 tuple 0x076ef1ea ,						// magic
0 , 0 , 									// actions msg_sents
now , 										// unix_time
1 , 1 , 0 , 								// block_lt, trans_lt, rand_seed
 0 tuple 9223372036854775807 , dictnew , , 	// remaining balance
0 , dictnew , 								// contract_address, global_config
1 tuple 									// wrap to another tuple
constant c7 

message recv_external code storage c7 runvmctx
cr cr <s csr. cr cr